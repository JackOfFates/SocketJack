name: "Deploy to nuget"
on: ["push"]

jobs: 
 deploy:
    name: "Deploy"
    runs-on: windows-latest
    steps:
    - name: "Checkout"
      uses: actions/checkout@v2

    - name: "Setup .NET"
      uses: actions/setup-dotnet@v1
      with:
         dotnet-version: "8.0.x"

    - name: "Restore dependencies"
      run: dotnet restore ./SocketJack/SocketJack.csproj

    - name: "Build"
      run: dotnet build ./SocketJack.csproj --configuration Release --no-restore

    - name: "Pack Project"
      run: dotnet pack ./SocketJack.csproj --configuration Release --no-build --include-symbols --output ./nupkg

    - name: "Push to NuGet"
      run: dotnet nuget push ./nupkg/*.nupkg -k ${{ secrets.NUGET_API_KEY }} -s https://api.nuget.org/v3/index.json
